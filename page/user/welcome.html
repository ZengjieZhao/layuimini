<style>
    .top-panel {border:1px solid #eceff9;border-radius:5px;text-align:center;}
    .top-panel > .layui-card-body {height:60px;}
    .top-panel-number {line-height:60px;font-size:30px;}
    .top-panel-tips {line-height:30px;font-size:12px}
    #allmap {
        height: 600px;
        overflow: hidden;
        margin: 10px;
        font-family: "微软雅黑";
    }
</style>
<div class="layuimini-container layuimini-page-anim">
    <div class="layuimini-main">
        <div class="layui-row layui-col-space15">
            <div class="layui-col-xs12 layui-col-md3">

                <div class="layui-card top-panel">
                    <div class="layui-card-header">站点数量</div>
                    <div class="layui-card-body">
                        <div class="layui-row layui-col-space5">
                            <div class="layui-col-xs12 layui-col-md12 top-panel-number">
                               1
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="layui-col-xs12 layui-col-md3">

                <div class="layui-card top-panel">
                    <div class="layui-card-header">注册用户数量</div>
                    <div class="layui-card-body">
                        <div class="layui-row layui-col-space5">
                            <div id="user-number" class="layui-col-xs12 layui-col-md12 top-panel-number">
                                
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="layui-col-xs12 layui-col-md3">

                <div class="layui-card top-panel">
                    <div class="layui-card-header">伞借出数量</div>
                    <div class="layui-card-body">
                        <div class="layui-row layui-col-space5">
                            <div id="umbrella-borrowed-number" class="layui-col-xs12 layui-col-md12 top-panel-number">
                                
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="layui-col-xs12 layui-col-md3">

                <div class="layui-card top-panel">
                    <div class="layui-card-header">伞剩余数量</div>
                    <div class="layui-card-body">
                        <div class="layui-row layui-col-space5">
                            <div  id="umbrella-insite-number" class="layui-col-xs12 layui-col-md12 top-panel-number">
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class = "layui-row">
            <div class = "layui-col-xs12 layui-col-md12">
                <div id="allmap"></div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    //获取所有站点
    //遍历站点并标点
    //http://api.map.baidu.com/lbsapi/getpoint/index.html
    var map = new BMapGL.Map("allmap");    // 创建Map实例
    map.centerAndZoom(new BMapGL.Point(117.066638, 36.681366), 18);  // 初始化地图,设置中心点坐标和地图级别(山东大学中心校区)
    map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
    // 创建点标记
    var point = new BMapGL.Point(117.065458,36.682189);
    var marker1 = new BMapGL.Marker(point);//齐园餐厅
    // 在地图上添加点标记
    map.addOverlay(marker1);
    // 创建信息窗口
    var opts = {
        width: 200,
        height: 100,
        title: '齐园餐厅'
    };
    var infoWindow = new BMapGL.InfoWindow('地址：齐园餐厅', opts);
    // 点标记添加点击事件
    marker1.addEventListener('click', function () {
        map.openInfoWindow(infoWindow, point); // 开启信息窗口
    });
    layui.use(['form', 'jquery'], function () {
            var $ = layui.jquery;
            var unum = "";
            var umbnum = "";
            var uminum = "";
            $.ajax(
                    {
                        url: "http://127.0.0.1:8088/admin/statistic",
                        method: "get",
                        dataType: 'json',
                        success: function (res) {
                            console.log('success');
                            console.log(res);
                            unum = res.data.unum;
                            umbnum = res.data.umbnum;
                            uminum =  res.data.uminum;
                            $('#user-number').empty();
                            $('#user-number').append(unum);
                            $('#umbrella-borrowed-number').empty();
                            $('#umbrella-borrowed-number').append(umbnum);
                            $('#umbrella-insite-number').empty();
                            $('#umbrella-insite-number').append(uminum);
                        },
                        error: function (res) {
                            layer.msg('获取统计数据失败');
                        }
                    }
                );
    });
</script>
